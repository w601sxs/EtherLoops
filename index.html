<html>

    <head>
        <script src="js/jquery.min.js"></script>
	<!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/css/materialize.min.css">

    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/js/materialize.min.js"></script>
            
	
        <script src="js/loopr_audio.js"></script>
        
        <link rel="stylesheet" type="text/css" href="css/style.css">
        <link href='https://fonts.googleapis.com/css?family=Dosis' rel='stylesheet' type='text/css'>
        <script>
            
            randomColor = function () {
                    return "rgba(" + Math.floor(Math.random() * 255) + "," + Math.floor(Math.random() * 255) + "," + Math.floor(Math.random() * 255) + ",1)";
                };

	  document.addEventListener('DOMContentLoaded', function() {
    var elems = document.querySelectorAll('.sidenav');
    var instances = M.Sidenav.init(elems, options);
  });

            $(document).ready(function () {

                // $('#wrapper').load('partials/128bpm.html');

                //for each div, let's get the URL and give each div the audio functions
                $('#sp span').each(function () {
                    addAudioProperties(this);
                });
		    
		$('.sidenav').sidenav();

            });

            //clicking one of the bpm options will load the appropriate partial, add the audio properties to each span, and then reset the .js to the new beat
            $(document).on('click','a.new-bpm',function(){
                 var bpm = $(this).attr('bpm');
                 $('#wrapper').load('partials/' + bpm + 'bpm.html', function(){
                    $('#sp span').each(function () {
                        addAudioProperties(this);
                    });
                    changeBPM(bpm);
                 });
		 context.resume().then(() => {
    			console.log('Playback resumed successfully 1');
  		 });
                 return false;
            });

            //on click, check to see if we have a grey box or a colored box
            //play or stop accordingly
            $(document).on('click','#sp span',function(){
		
		 context.resume().then(() => {
    			console.log('Playback resumed successfully 2');
  		 });
		 
                if ($(this).css('background-color') === 'rgba(0, 0, 0, 0)')
                {
                    var cclr = randomColor;
                    $(this).css('background-color', 'rgba(0,0,0,1)');
                    
                    this.addToLoops();
                }else{
                    this.stop();
                    this.removeLoop();
                    $(this).css('background-color','rgba(0, 0, 0, 0)');
                    $(this).css('opacity',1);
                }
            });

            $(window).load(function(){
                $('a.btn').click(function(){
                   
                    //console.log($(this).attr('class'));
                    if ($(this).attr('class') === 'btn active')
                    {
                        $(this).css( "background","rgba(44,62,80,1)");
                        
                    }else{
                        $( this ).css("background",randomColor);
                        
                    }
                    $( this ).toggleClass( "active" );
 
                });
            });
            
            
        </script>
	
        <title>EtherLoops</title>
    </head>

<body>
<div id='wrapper'>
    <div class='background'>
        <!--
	    <p><a class='new-bpm' href='#' bpm='140'>140</a> | <a class='tempo' href='#' bpm='128'>128</a> | <a class='new-bpm' href='#' bpm='90'>90</a></p>
	-->
        <canvas id="beat-bar"></canvas>
       
        <div class='backgroundlayer'>
            <div id="sp" class="button-group-navigation" target="_blank">
                <div class="bass">
                    <span id="pad1" data-sound="sounds/VEEElectroLoop001.wav"><li><a class="btn" href="#"></a></li></span>
                    <span id="pad1" data-sound="sounds/VFX2Bass1128BPMcopy.wav"><li><a class="btn" href="#"></a></li></span>
                    <span id="pad1" data-sound="sounds/VFX2Bass2128BPMcopy.wav"><li><a class="btn" href="#"></a></li></span>
                    <span id="pad1" data-sound="sounds/VFX2Bass3128BPMcopy.wav"><li><a class="btn" href="#"></a></li></span>
                </div>
                <div class='loops'>
                    <hr>
                    <span id="pad2" data-sound="sounds/VEH2SpecialSounds-13copy.wav"><li><a class="btn" href="#"></a></li></span>
                    <span id="pad3" data-sound="sounds/VEH2SpecialSounds-36copy.wav"><li><a class="btn" href="#"></a></li></span>
                    <span id="pad4" data-sound="sounds/VEH2SpecialSounds-28copy.wav"><li><a class="btn" href="#"></a></li></span><br>
                    <span id="pad4" data-sound="sounds/VFX2Beat128BPMcopy.wav"><li><a class="btn" href="#"></a></li></span>
                    <span id="pad4" data-sound="sounds/VFX2Loop006128BPMcopy.wav"><li><a class="btn" href="#"></a></li></span>
                    <span id="pad4" data-sound="sounds/VFX2Loop006128BPMcopy.wav"><li><a class="btn" href="#"></a></li></span><br>
                    <span id="pad4" data-sound="sounds/VFX2Loop006128BPMcopy.wav"><li><a class="btn" href="#"></a></li></span>
                    <span id="pad4" data-sound="sounds/VFX2Loop006128BPMcopy.wav"><li><a class="btn" href="#"></a></li></span>
                    <span id="pad4" data-sound="sounds/VFX2Loop006128BPMcopy.wav"><li><a class="btn" href="#"></a></li></span>
                    
                </div>
                <div class='drums'>
                    <hr>
                    <span id="pad5" data-sound="sounds/VEEElectroLoop001.wav"><li><a class="btn" href="#"></a></li></span>
                    <span id="pad5" data-sound="sounds/VEEElectroLoop007.wav"><li><a class="btn" href="#"></a></li></span>
                    <span id="pad5" data-sound="sounds/VEEElectroLoop352copy.wav"><li><a class="btn" href="#"></a></li></span>
                    <span id="pad5" data-sound="sounds/VEEElectroLoop455copy.wav"><li><a class="btn" href="#"></a></li></span>
                </div>
            </div>
        
        </div>
    </div>
     
</div>
<script src="js/loopr_canvas.js"></script>
  <nav> <!-- navbar content here  --> </nav>

  <ul id="slide-out" class="sidenav">
    <li><div class="user-view">
      <div class="background">
        <img src="images/office.jpg">
      </div>
      <a href="#user"><img class="circle" src="images/yuna.jpg"></a>
      <a href="#name"><span class="white-text name">John Doe</span></a>
      <a href="#email"><span class="white-text email">jdandturk@gmail.com</span></a>
    </div></li>
    <li><a href="#!"><i class="material-icons">cloud</i>First Link With Icon</a></li>
    <li><a href="#!">Second Link</a></li>
    <li><div class="divider"></div></li>
    <li><a class="subheader">Subheader</a></li>
    <li><a class="waves-effect" href="#!">Third Link With Waves</a></li>
  </ul>
  <a href="#" data-target="slide-out" class="sidenav-trigger"><i class="material-icons">menu</i></a>
</body>
</html>
